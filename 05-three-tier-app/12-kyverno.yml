# apiVersion: kyverno.io/v1
# kind: Policy
# metadata:
#   name: check-vulnerabilities
#   namespace: prod
# spec:
#   validationFailureAction: Enforce
#   webhookTimeoutSeconds: 30
#   failurePolicy: Fail
#   rules:
#     - name: not-older-than-1-week
#       match:
#         any:
#           - resources:
#               kinds:
#                 - Pod
#                 - Deployment
#       verifyImages:
#         - imageReferences:
#             - "*"
#           attestors:
#             - count: 1
#               entries:
#                 - keys:
#                     secret:
#                       name: cosign-public-key
#                       namespace: kyverno
#                   repository: index.docker.io/harishnshetty/frontend-signed
#          attestations:
#            - type: https://cosign.sigstore.dev/attestation/vuln/v1
#              conditions:
#                - all:
#                    - key: "{{ time_since('','{{ predicate.metadata.scanFinishedOn }}', '') }}"
#                      operator: LessThanOrEquals
#                      value: "168h"
